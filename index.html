<!doctype html>
<html lang="en" data-theme="forest">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ThreadlessCoin · ALPHA</title>

<!-- Security -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  base-uri 'none';
  img-src 'self' data:;
  style-src 'self' 'unsafe-inline';
  script-src 'self' https://cdn.jsdelivr.net;
  connect-src 'self' https://*.supabase.co wss://*.supabase.co;
  upgrade-insecure-requests;">

<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%230e1613'/%3E%3Cpath d='M16 20h32M16 32h32M16 44h32' stroke='%23ff8b3d' stroke-width='6' stroke-linecap='round'/%3E%3C/svg%3E">

<style>
/* ============== Threadless theme tokens (unchanged) ============== */
:root{ --bg:#0e1613; --card:#122019; --ink:#e9f5ee; --muted:#9db7ab; --line:#1e2e27;
  --accent:#ff8b3d; --accent-2:#1f9d68; --accent-2-ink:#06120d; --warn:#ffd08f; --bad:#ff8c8c;
  --font: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; --btn-ink:#28150a }
[data-theme="forest"]{ --bg:#0e1613; --card:#122019; --ink:#e9f5ee; --muted:#9db7ab; --line:#1e2e27; --accent:#ff8b3d; --accent-2:#1f9d68; --accent-2-ink:#06120d; --warn:#ffd08f }
[data-theme="sunset"]{ --bg:#160f12; --card:#22161b; --ink:#ffeef3; --muted:#c5a7b3; --line:#2d1e25; --accent:#ff6b6b; --accent-2:#ffb86b; --accent-2-ink:#2b130f; --warn:#ffe0b5 }
[data-theme="midnight"]{ --bg:#0d0f19; --card:#121427; --ink:#e9ebff; --muted:#a9b0d4; --line:#1a1d36; --accent:#8ab4ff; --accent-2:#6ae6c1; --accent-2-ink:#021410; --warn:#ffd9a3 }
[data-theme="ocean"]{ --bg:#07171d; --card:#0d2330; --ink:#e6fbff; --muted:#a6c9d6; --line:#143244; --accent:#26b0ff; --accent-2:#15d1b2; --accent-2-ink:#01221c; --warn:#ffe6b8 }
[data-theme="grape"]{ --bg:#160d1a; --card:#231128; --ink:#f6e9ff; --muted:#c7abd8; --line:#31153b; --accent:#c47dff; --accent-2:#ff9fb3; --accent-2-ink:#2b0c18; --warn:#ffe0c1 }
[data-theme="mono"]{ --bg:#0c0c0c; --card:#141414; --ink:#f5f5f5; --muted:#bcbcbc; --line:#202020; --accent:#ffffff; --accent-2:#d0d0d0; --accent-2-ink:#121212; --warn:#ffd08f }
[data-theme="x"]{ --bg:#000; --card:#0a0a0a; --ink:#e7e9ea; --muted:#71767b; --line:#2f3336; --accent:#1d9bf0; --accent-2:#1d9bf0; --accent-2-ink:#00131f; --warn:#ffd9a3; --btn-ink:#fff }
[data-theme="buran"]{ --bg:#0b0c0e; --card:#121418; --ink:#f0f1f3; --muted:#a2a8b3; --line:#1f232b; --accent:#d52b1e; --accent-2:#84b6ff; --accent-2-ink:#06121f; --warn:#ffcc66; --btn-ink:#fff }
[data-theme="halloween"]{ --bg:#0b0a12; --card:#13111b; --ink:#f7efe4; --muted:#b7a8c6; --line:#241f33; --accent:#ff7a00; --accent-2:#39ff88; --accent-2-ink:#02150a; --warn:#ffd39b; --btn-ink:#1a0e05 }
/* Backdrops (same vibe as Threadless) */
html,body{height:100%} body{
  margin:0;
  background:
    radial-gradient(1200px 600px at 20% -10%, color-mix(in srgb, var(--card) 60%, transparent) 0%, transparent 60%),
    radial-gradient(1000px 800px at 120% -20%, color-mix(in srgb, var(--card) 60%, transparent) 0%, transparent 55%),
    var(--bg);
  color:var(--ink); font:16px/1.5 var(--font);
}
[data-theme="x"] body{ background: var(--bg)!important; }
[data-theme="buran"] body{
  background:
    radial-gradient(900px 500px at 10% -10%, color-mix(in srgb, var(--card) 55%, transparent) 0%, transparent 60%),
    radial-gradient(800px 700px at 110% -20%, color-mix(in srgb, var(--card) 55%, transparent) 0%, transparent 55%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.025), rgba(255,255,255,.025) 2px, transparent 2px, transparent 6px),
    var(--bg)!important;
}
[data-theme="halloween"] body{
  background:
    radial-gradient(180px 180px at 85% 12%, rgba(255,245,200,.9) 0 35%, rgba(255,245,200,.06) 36% 45%, transparent 46%),
    radial-gradient(1200px 500px at -10% 0%, rgba(90,70,140,.18) 0 30%, transparent 55%),
    radial-gradient(900px 400px at 120% -10%, rgba(90,70,140,.14) 0 30%, transparent 60%),
    repeating-radial-gradient(circle at 10% 20%, rgba(255,255,255,.12) 0 1px, transparent 1px 40px),
    repeating-radial-gradient(circle at 70% 40%, rgba(255,255,255,.10) 0 1px, transparent 1px 36px),
    var(--bg)!important;
  background-attachment: fixed,fixed,fixed,fixed,fixed,fixed;
}

/* Layout + components (matches Threadless feel) */
header{ position:sticky; top:0; z-index:3;
  background:linear-gradient(180deg, color-mix(in srgb, var(--card) 85%, transparent), transparent);
  backdrop-filter: blur(6px); border-bottom:1px solid var(--line) }
.wrap{max-width:860px;margin:0 auto;padding:16px}
.topbar{display:flex; align-items:center; justify-content:space-between; gap:12px}
.brand{display:flex; align-items:center; gap:12px}
.logo{ width:32px;height:32px;border-radius:10px;background:var(--bg);border:1px solid var(--line); display:grid; place-items:center }
.logo::after{ content:'₿'; color:var(--accent); font-weight:900; }

h1{margin:0 0 4px; font-size:22px; letter-spacing:.2px}
.sub{color:var(--muted); font-size:13px}
.theme-switch{ display:flex; align-items:center; gap:8px; color:var(--muted); font-size:12px }
.theme-select{ appearance:none; border:1px solid var(--line); background:var(--card); color:var(--ink); border-radius:10px; padding:6px 10px; cursor:pointer }

.card{background:var(--card); border:1px solid var(--line); border-radius:16px; padding:14px; margin:12px 0; box-shadow:0 10px 30px rgba(0,0,0,.2)}
.row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
input,select{border-radius:10px;border:1px solid var(--line);padding:8px 10px;background:color-mix(in srgb,var(--bg) 92%,black 8%);color:var(--ink)}
button{ border:0; border-radius:12px; padding:10px 14px; background:linear-gradient(180deg, var(--accent), color-mix(in srgb, var(--accent) 75%, #000 25%)); color:var(--btn-ink); font-weight:800; cursor:pointer; box-shadow:0 6px 18px color-mix(in srgb, var(--accent) 25%, transparent), inset 0 1px 0 rgba(255,255,255,.15) }
button[disabled]{opacity:.55; cursor:not-allowed}
pre,code{font-family:ui-monospace,SFMono-Regular,Consolas,monospace; color:var(--muted)}
.notice{color:var(--warn); font-size:12px}
.footer{color:var(--muted); font-size:12px; text-align:center; margin:24px 0}
.toast{position:fixed; bottom:18px; left:50%; transform:translateX(-50%); background:var(--card); border:1px solid var(--line); color:var(--ink); padding:10px 14px; border-radius:10px; box-shadow:0 8px 24px rgba(0,0,0,.25); font-size:13px; display:none}
@media (max-width:720px){ .wrap{padding:12px} .topbar{flex-wrap:wrap} .brand{flex:1 1 100%} }
</style>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" crossorigin="anonymous"></script>
<script defer src="env.js"></script>
<script defer src="app.js"></script>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="topbar">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>ThreadlessCoin</h1>
            <div class="sub">Community coin for Threadless · ALPHA</div>
          </div>
        </div>
        <div class="theme-switch">
          Theme:
          <select id="theme" class="theme-select">
            <option value="forest">Forest</option>
            <option value="sunset">Sunset</option>
            <option value="midnight">Midnight</option>
            <option value="ocean">Ocean</option>
            <option value="grape">Grape</option>
            <option value="mono">Mono</option>
            <option value="x">X</option>
            <option value="buran">Buran</option>
            <option value="halloween">Halloween</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="card" id="auth">
      <h3>Sign in / Sign up</h3>
      <div class="row">
        <input id="email" placeholder="email" type="email" autocomplete="email">
        <input id="password" placeholder="password" type="password" autocomplete="new-password">
        <button id="loginBtn">Login</button>
        <button id="signupBtn">Sign up</button>
        <span class="notice" id="authNote"></span>
      </div>
    </div>

    <div class="card" id="profile" style="display:none">
      <h3>Profile</h3>
      <div class="row">
        <input id="username" placeholder="username (3–20)">
        <button id="saveUserBtn">Save username</button>
        <span id="meUser"></span>
      </div>
    </div>

    <div class="card" id="wallet" style="display:none">
      <h3>Wallet</h3>
      <div class="row">Balance: <strong id="balance">0</strong> TLC</div>
      <div class="row">
        <input id="toUser" placeholder="send to @username">
        <input id="amt" type="number" min="1" step="1" placeholder="amount">
        <button id="sendBtn">Send</button>
      </div>
    </div>

    <div class="card" id="mining" style="display:none">
      <h3>Mining</h3>
      <div class="row">
        <select id="difficulty">
          <option value="3">Easy (3)</option>
          <option value="4" selected>Normal (4)</option>
          <option value="5">Hard (5)</option>
        </select>
        <button id="issueBtn">Get challenge</button>
        <button id="mineBtn" disabled>Start mining</button>
        <span id="hashrate"></span>
      </div>
      <pre id="challengeView"></pre>
    </div>

    <div class="card" id="friends" style="display:none">
      <h3>Friends</h3>
      <div class="row">
        <input id="friendUser" placeholder="add @username">
        <button id="addFriendBtn">Add</button>
      </div>
      <ul id="friendList"></ul>
    </div>

    <div class="card" id="packages" style="display:none">
      <h3>Packages (gift codes)</h3>
      <div class="row">
        <input id="pkgAmt" type="number" min="1" step="1" placeholder="amount">
        <button id="mkPkgBtn">Create package</button>
      </div>
      <div id="pkgOut"></div>
      <div class="row" style="margin-top:8px">
        <input id="redeemCode" placeholder="paste passID">
        <button id="redeemBtn">Redeem</button>
      </div>
    </div>

    <div class="footer">© 2025 ThreadlessCoin (prototype)</div>
  </main>

  <div class="toast" id="toast"></div>
</body>
</html>
